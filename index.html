<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Quản lý sinh viên</title>
</head>

<body>

    <h2>Thông tin sinh viên</h2>

    <input type="hidden" id="studentId">
    <input type="text" id="name" placeholder="Nhập tên">
    <input type="text" id="phone" placeholder="Nhập phone">
    <input type="text" id="avatar" placeholder="Nhập link ảnh">

    <button onclick="saveStudent()" id="saveBtn">Thêm</button>

    <hr>

    <h2>Danh sách sinh viên</h2>

    <table border="1" cellpadding="10">
        <thead>
            <tr>
                <th>ID</th>
                <th>Avatar</th>
                <th>Tên</th>
                <th>Phone</th>
                <th>Hành động</th>
            </tr>
        </thead>
        <tbody id="studentTable"></tbody>
    </table>

    <script>
        const API_URL = "https://698590156964f10bf2539131.mockapi.io/sinhvien";

        async function loadStudents() {
            const res = await fetch(API_URL);
            const data = await res.json();
            const table = document.getElementById("studentTable");
            table.innerHTML = "";

            data.forEach(sv => {
                const tr = document.createElement("tr");
                tr.innerHTML = `
            <td>${sv.id}</td>
            <td><img src="${sv.avatar}" width="50"></td>
            <td>${sv.name}</td>
            <td>${sv.phone}</td>
            <td>
                <button onclick="fillForm('${sv.id}', '${sv.name}', '${sv.phone}', '${sv.avatar}')">Sửa</button>
                <button onclick="deleteStudent('${sv.id}')">Xóa</button>
            </td>
        `;
                table.appendChild(tr);
            });
        }

        function fillForm(id, name, phone, avatar) {
            document.getElementById("studentId").value = id;
            document.getElementById("name").value = name;
            document.getElementById("phone").value = phone;
            document.getElementById("avatar").value = avatar;

            document.getElementById("saveBtn").innerText = "Cập nhật";
        }

        async function saveStudent() {
            const id = document.getElementById("studentId").value;
            const name = document.getElementById("name").value;
            const phone = document.getElementById("phone").value;
            const avatar = document.getElementById("avatar").value;

            if (!name || !phone || !avatar) {
                alert("Vui lòng nhập đầy đủ!");
                return;
            }

            if (id) {
    
                await fetch(`${API_URL}/${id}`, {
                    method: "PUT",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ name, phone, avatar })
                });
            } else {
          
                await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ name, phone, avatar })
                });
            }

            clearForm();
            loadStudents();
        }

        async function deleteStudent(id) {
            await fetch(`${API_URL}/${id}`, { method: "DELETE" });
            loadStudents();
        }

        function clearForm() {
            document.getElementById("studentId").value = "";
            document.getElementById("name").value = "";
            document.getElementById("phone").value = "";
            document.getElementById("avatar").value = "";
            document.getElementById("saveBtn").innerText = "Thêm";
        }

        loadStudents();
    </script>

</body>

</html>
